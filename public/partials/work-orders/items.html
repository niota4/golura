
<div class="view-purchase-order-items-container view-details-container">
    <div class="view-purchase-order-items list-container view-details">
        <div 
            class="grid-y overflow-hidden"
            ng-class="{'golura-mobile-block': $root.UI.isMobile, 'golura-block': !$root.UI.isMobile}"
        >
            <div class="cell shrink">
                <h2>
                    <b>
                        Purchase Order Items
                    </b>
                </h2>
            </div>
            <div class="cell shrink">
                <div class="view-purchase-order-items-search-container list-search-container">
                    <div class="view-purchase-order-items-search list-search">
                        <div class="search-input-container">
                            <div class="grid-x align-middle">
                                <div class="cell auto align-self-bottom">
                                    <input
                                        class="view-purchase-order-items-search-input search-input"
                                        id="itemSearchInput" 
                                        type="text"
                                        placeholder="Search items..."
                                        ng-model="search.PurchaseOrderItems.value"
                                    />
                                </div>
                                <div class="cell shrink align-self-bottom">
                                    <span class="search-icon">
                                        <i class="fal fa-search"></i>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div 
                class="cell small-12 medium-auto large-auto"
                ng-class="{'overflow-scroll': !$root.UI.isMobile}"
            >
                <ul class="view-purchase-order-items-list list">
                    <li ng-show="!UI.purchaseOrderLoaded">
                        <div class="ssc purchase-order-item-ssc">
                            <div 
                                class="ssc-square"
                                ng-repeat="x in [].constructor(40) track by $index"
                            ></div>
                        </div>
                    </li>
                    <li 
                        class="view-purchase-orders-list-item text-center"
                        ng-if="!filteredItems.length &&
                        UI.purchaseOrderLoaded"
                    >
                        <h5>
                            <b>No Purchase Order Items Found</b>
                        </h5>
                        <button 
                            class="add-purchase-order-item-button button success expanded white-text" 
                            type="button"
                            ng-click="initVendorItems()"
                            data-open="addItemFormReveal"
                            ng-if="permissions.canEdit && 
                            !purchaseOrder.PurchaseOrderItems.length &&
                            $root.UI.isMobile"
                        >
                            <i class="fal fa-plus-circle"></i> Add Items
                        </button>
                    </li>
                    <li
                        class="view-purchase-order-items-list-item list-item position-relative"
                        ng-repeat="item in filteredItems = 
                        (purchaseOrder.PurchaseOrderItems | filter:search.purchaseOrderItems.value) 
                        track by $index"
                        ng-class="{'expanded': item.updateItemToLineItem}"
                    >
                        <div class="grid-x grid-margin-x">
                            <div class="cell auto">
                                <h6>
                                    <b>Part Number: </b>
                                    <a ng-href="inventory/items/item/{{item.Item.id}}">
                                        {{item.Item.partNumber}}
                                    </a>
                                </h6>
                                <h6>
                                    <b>Name: </b>
                                    {{item.Item.name}}
                                </h6>
                                <h6>
                                    <b>Quantity: </b>
                                    {{item.quantity}}
                                </h6>
                                <h6>
                                    <b>Unit Price: </b>
                                    ${{item.unitPrice | number}}
                                </h6>
                                <h6>
                                    <b>Total Cost: </b>
                                    ${{item.totalCost | number}}
                                </h6>
                                <h6 ng-if="item.Item.description">
                                    <b>Description: </b>
                                    {{item.Item.description}}
                                </h6>
                            </div>
                            <div class="cell shrink">
                                <button  
                                    class="list-item-options-button button white-text"
                                    type="button"
                                    ng-class="{'success': !item.WorkOrderLineItem}"
                                    ng-click="item.updateItemToLineItem = !item.updateItemToLineItem"
                                    ng-if="item.WorkOrderLineItem"
                                >
                                    <span ng-if="!item.WorkOrderLineItem">
                                        <i class="fal fa-plus-circle"></i> Add to Line Item
                                    </span>
                                    <span ng-if="item.WorkOrderLineItem">
                                        <i class="fal fa-arrow-turn-down-right"></i> Move Item to Line Item
                                    </span>
                                </button>
                                <button  
                                    class="list-item-options-button button alert white-text"
                                    type="button"
                                    ng-click="item.remove = !item.remove"
                                    ng-if="permissions.canArchive"
                                >
                                    <i class="fal fa-times-circle"></i> Remove
                                </button>
                            </div>
                        </div>
                        <div 
                            class="view-purchase-order-items-list-item-add-line-item-container black-overlay"
                            ng-if="item.updateItemToLineItem"
                        >   
                            <div 
                                class="grid-x grid-margin-x align-middle white-text"
                                ng-if="!workOrder.LineItems.length"
                            >
                                <div class="cell small-12 medium-shrink large-shrink">
                                    <span class="view-purchase-order-items-list-item-add-line-item-icon warning-text">
                                        <i class="fal fa-circle-exclamation"></i>
                                    </span>
                                </div>
                                <div class="cell small-12 medium-auto large-auto">
                                    <h4 class="white-text">
                                        <b>
                                            There are no Line Items to choose from! Add some to the Work Order!
                                        </b>
                                    </h4>
                                </div>
                                <div class="cell small-12 medium-shrink large-shrink">       
                                    <div class="button-group">
                                        <a 
                                            class="list-item-options-button button white-text"
                                            ng-href="work-order/work-order/{{workOrder.id}}/edit"
                                            ng-if="permissions.canEdit"
                                            ng-cloak
                                        >
                                            <i class="fal fa-edit"></i> Edit Work Order
                                        </a>
                                        <button 
                                            class="button warning white-text"
                                            type="button"
                                            ng-click="item.updateItemToLineItem = !item.updateItemToLineItem"
                                        >
                                            <i class="fal fa-times-circle"></i> Close
                                        </button>
                                    </div>
                                </div>
                            </div>                
                            <div 
                                class="golura-form golura-block grid-x grid-margin-x white-text"
                                ng-if="workOrder.LineItems.length"
                            >
                                <div class="cell small-12 medium-auto large-auto">
                                    <div class="input-container">
                                        <label for="addEstimateProgressOperator">
                                            Item
                                            <span class="alert-text">
                                                *
                                            </span>
                                        </label>
                                        <selectize
                                            class="form-input"
                                            config="itemOptions"
                                            options="workOrder.LineItems"
                                            id="itemlineItemId-{{$index}}"
                                            ng-model="item.lineItemId"
                                            required
                                        >
                                        </selectize>
                                    </div>
                                </div>
                                <div class="cell small-12 medium-auto large-auto">
                                    <button
                                        class="add-button button white-text"
                                        type="button"
                                        ng-class="{'form-alert': item.deleting}"
                                        ng-click="updateItemtoLineItem(item)"
                                    >
                                        <span ng-if="!item.adding">
                                            <i class="fal fa-times-circle"></i> Confirm
                                        </span>
                                        <span ng-if="item.adding">
                                            Please Wait...
                                        </span>
                                    </button>
                                    <button 
                                        class="button warning white-text"
                                        type="button"
                                        ng-click="item.updateItemToLineItem = !item.updateItemToLineItem"
                                    >
                                        <i class="fal fa-times-circle"></i> Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div 
                            class="view-purchase-order-items-list-item-remove-container black-overlay"
                            ng-if="item.remove"
                        >
                            <div class="golura-block grid-x grid-margin-x align-middle white-text">
                                <div class="cell small-12 medium-auto large-auto">
                                    <h4>
                                        <b class="alert-text">Warning: </b>
                                        <span class="white-text">Are you sure you want to remove 
                                            this Item?
                                        </span>
                                    </h4>
                                </div>
                                <div class="cell small-12 medium-auto large-auto">
                                    <button
                                        class="delete-button button alert white-text"
                                        type="button"
                                        ng-class="{'form-alert': item.deleting}"
                                        ng-click="removeItemFromPurchaseOrder(item)"
                                    >
                                        <span ng-if="!item.deleting">
                                            <i class="fal fa-times-circle"></i> Confirm
                                        </span>
                                        <span ng-if="item.deleting">
                                            Please Wait...
                                        </span>
                                    </button>
                                    <button 
                                        class="button warning white-text"
                                        type="button"
                                        ng-click="item.remove = !item.remove"
                                    >
                                        <i class="fal fa-times-circle"></i> Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>