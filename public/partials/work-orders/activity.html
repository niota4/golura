<div 
    class="view-work-order-activity-container view-work-order-container view-container"
    ng-init="initWorkOrder();"
>
    <div class="view-work-order-activity view-work-order">
        <div class="golura-block grid-y">
            <div class="cell shrink position-relative">
                <div class="view-work-order-activity-search-container list-search-container">
                    <div class="view-work-order-activity-search list-search">
                        <div class="search-input-container">
                            <div class="grid-x align-middle">
                                <div class="cell shrink">
                                    <div class="view-work-order-search-create-button-container create-button-container">
                                        <a 
                                            class="view-work-order-create-button create-button submit-button button warning white-text" 
                                            ng-click="$root.goBack()"
                                        >
                                            <i class="fal fa-circle-arrow-left"></i> Back
                                        </a>
                                    </div>
                                </div>
                                <div class="cell auto align-self-bottom">
                                    <input
                                        class="view-work-order-activity-search-input search-input"
                                        id="viewWorkOrderActivitySearchInput" 
                                        type="text"
                                        placeholder="Search activities..."
                                        ng-model="search.workOrderActivity.value"
                                    />
                                </div>
                                <div class="cell shrink align-self-bottom">
                                    <span class="search-icon">
                                        <i class="fal fa-search"></i>
                                    </span>
                                </div>
                                <div class="cell shrink">
                                    <div class="cell shrink">
                                        <div class="sort-input-container">
                                            <div class="grid-x">
                                                <div class="cell auto">
                                                    <selectize
                                                        class="view-work-order-activity-search-sort-input form-input sort-input"
                                                        id="workOrderActivitySearchSortInput"
                                                        config="sortOptions"
                                                        options="viewWorkOrderActivityOptions"
                                                        ng-model="sort.workOrderActivity.id"
                                                        ng-change="orderBy(sort.workOrderActivity.id)"
                                                        ng-cloak
                                                    >
                                                    </selectize>
                                                </div>
                                                <div class="cell shrink">
                                                    <span class="sort-icon">
                                                        <i class="fal fa-sort"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="cell shrink">
                <div class="view-work-order-activity-list-header-container list-header-container">
                    <div class="view-work-order-activity-list-header list-header">
                        <div class="grid-x grid-padding-x align-middle align-left">
                            <div class="cell small-12 medium-2 large-2">
                                <h3>
                                    <b>Changed By</b>
                                </h3>
                            </div>
                            <div class="cell small-12 medium-1 large-1">
                                <h3>
                                    <b>Action</b>
                                </h3>
                            </div>
                            <div class="cell small-12 medium-1 large-1">
                                <h3>
                                    <b>Type</b>
                                </h3>
                            </div>
                            <div class="cell small-12 medium-auto large-auto">
                                <h3>
                                    <b>Description</b>
                                </h3>
                            </div>
                            <div class="cell small-12 medium-2 large-2">
                                <h3>
                                    <b>Time changed</b>
                                </h3>
                            </div>
                            <div 
                                class="cell small-12 medium-2 large-2"
                                ng-if="permissions.canEdit"
                            >
                                <h3 class="list-header-options">
                                    <b>Options</b>
                                </h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="cell auto overflow-scroll">
                <div class="view-work-order-activity-list-container list-container">
                    <ul 
                        class="view-work-order-activity-list list"
                        id="workOrderActivitiesList"
                    >
                        <li ng-if="!UI.workOrderActivitiesLoaded">
                            <div class="ssc view-work-order-activity-ssc">
                                <div 
                                    class="ssc-square"
                                    ng-repeat="x in [].constructor(20) track by $index"
                                ></div>
                            </div>
                        </li>
                        <li
                            class="view-work-order-activity-list-item list-item position-relative"
                            ng-repeat="a in filteredWorkOrderActivities = 
                            (activities | filter:search.workOrderActivity.value) |
                            orderBy: sort.workOrderActivity.value |
                            limitTo: UI.workOrderActivitiesDisplayed track by $index"
                            ng-class="{'selected': a.selected}"
                        >
                            <div format-users user="a.changedBy"></div>
                            <div class="grid-x grid-padding-x align-middle">
                                <div class="cell small-12 medium-2 large-2">
                                    <div class="view-work-order-activity-user-container">
                                        <div class="grid-x align-middle">
                                            <div class="cell shrink">
                                                <div 
                                                    class="comment-user-container"
                                                    ng-if="a.changedBy && a.changedBy.Preferences"
                                                >
                                                    <div class="golura-user-icon-container text-center frame-container">
                                                        <div 
                                                            class="golura-user-icon text-center" 
                                                            ng-style="{'background-color': a.changedBy.Preferences.backgroundColor}"
                                                        >
                                                            <h2 class="flex-child-auto align-middle">
                                                                <a 
                                                                    class="white-text"
                                                                    ng-href="users/user/{{a.changedBy.id}}"
                                                                    ng-cloak
                                                                >
                                                                    {{a.changedBy.shortName}}
                                                                </a>
                                                            </h2>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div 
                                                    class="comment-user-container"
                                                    ng-if="!a.changedBy || !a.changedBy.Preferences"
                                                >
                                                    <div class="golura-user-icon-container text-center frame-container">
                                                        <div 
                                                            class="golura-user-icon text-center" 
                                                            ng-style="{'background-color': '#000'}"
                                                        >
                                                            <h2 class="flex-child-auto align-middle">
                                                                <a 
                                                                    class="white-text"
                                                                    ng-href="users/user/{{a.changedBy.id}}"
                                                                    ng-cloak
                                                                >
                                                                    S
                                                                </a>
                                                            </h2>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="cell auto">
                                                <h6>
                                                    {{a.changedBy.fullName || 'System'}}
                                                </h6>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="cell small-12 medium-1 large-1">
                                    <h6>
                                        {{a.action}}
                                    </h6>
                                </div>
                                <div class="cell small-12 medium-1 large-1">
                                    <h6>
                                        {{a.formattedName}}
                                    </h6>
                                </div>
                                <div class="cell small-12 medium-auto large-auto">
                                    <h6 ng-bind-html="a.description">
                                    </h6>
                                </div>
                                <div class="cell small-12 medium-2 large-2">
                                    <h6>
                                        {{a.timestamp | DateTimeFormat}}
                                    </h6>
                                </div>
                                <div 
                                    class="cell small-12 medium-2 large-2"
                                    ng-if="permissions.canEdit"
                                >
                                    <div class="list-item-options-container">
                                        <button 
                                            class="list-item-options-button button warning white-text"
                                            type="button"
                                            ng-click="a.revert = !a.revert"
                                        >
                                            <i class="fal fa-undo"></i> Undo
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div 
                                class="list-item-delete-container list-item-delete-container black-overlay"
                                ng-if="a.revert"
                            >
                                <div class="grid-x grid-padding-x align-middle">
                                    <div class="cell small-12 medium-auto large-auto text-center">
                                        <h4>
                                            <b class="alert-text">Warning: </b>
                                            <span class="white-text">Are you sure you want to Undo
                                                this Change??
                                            </span>
                                        </h4>
                                    </div>
                                    <div class="cell small-12 medium-auto large-auto">
                                        <button 
                                            class="list-item-options-button button alert white-text"
                                            type="button"
                                            ng-disabled="UI.formSaving"
                                            ng-class="{'form-alert': UI.formSaving}"
                                            ng-click="revertWorkOrderActivity(a)"
                                        >
                                            <span ng-if="!UI.formSaving">
                                                <i class="fal fa-check-circle"></i> Confirm
                                            </span>
                                            <span ng-if="UI.formSaving">
                                                Please Wait...
                                            </span>
                                        </button>
                                        <button 
                                            class="list-item-options-button button warning white-text"
                                            type="button"
                                            ng-click="a.revert = !a.revert"
                                        >
                                            <i class="fal fa-times-circle"></i> Cancel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>