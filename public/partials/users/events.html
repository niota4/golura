<div 
    class="view-user-events-container view-user-container view-container"
    ng-init="initUser()"
>
    <div format-users user="user"></div>
    <div format-events events="events" events="pastEvents" future-events="futureEvents"></div>
    <div class="view-user-events view-user view">
        <div class="golura-block grid-y">
            <div class="cell shrink">
                <div class="grid-x grid-margin-x align-middle">
                    <div class="cell small-12 medium-12 large-4">
                        <div ng-include="'dist/partials/users/top-bar.html'"></div>
                    </div>
                    <div class="cell small-12 medium-12 large-auto">
                        <div 
                            ng-include="'/dist/navigations/user-navigation.html'"
                            ng-if="!$root.UI.isMobile"
                        ></div>
                    </div>
                </div>
            </div>
            <div class="cell shrink">
                <div class="button-group align-right">
                    <button
                        class="view-user-events-create-event-button submit-button create-button button white-text"
                        ng-class="{'alert': !UI.archiveEvents}"
                        id="viewUserEventsCreateEventButton"
                        type="button"
                        ng-if="subPermissions.workOrders.canArchive"
                        ng-click="initEvents(!UI.archiveEvents)"
                    >
                        <span ng-if="!UI.archiveEvents">
                            <i class="fal fa-box-archive"></i> View Archived
                        </span>
                        <span ng-if="UI.archiveEvents">
                            <i class="fal fa-search"></i> View Active
                        </span>
                    </button>
                </div>
            </div>
            <div class="cell auto">
                <div class="view-user-events-details-container view-details-container">
                    <div class="view-user-events-details view-details">
                        <h1 ng-if="!$root.UI.isMobile">
                            <b>
                                User Events
                            </b>
                        </h1>
                        <div class="grid-x">
                            <div class="cell small-12 medium-12 large-12">
                                <div class="view-user-events-container list-container">
                                    <ul 
                                        class="view-user-events-list list"
                                        id="viewUserEventsList"
                                        ng-if="UI.eventsLoaded"
                                    >
                                        <li ng-if="!events.length">
                                            <h5>
                                                <b>
                                                    No Events Found</b>
                                            </h5>
                                        </li>
                                        <li 
                                            class="view-user-events-list-item"
                                            ng-repeat="event in filteredEvents = 
                                            (events | filter: search.events.value | orderBy: '-endDate') |
                                            limitTo: UI.eventsDisplayed track by $index"
                                        >
                                            <div format-addresses address="event.Address"></div>
                                            <div class="grid-x grid-margin-x align-stretch">
                                                <div
                                                    class="view-user-events-list-item-date-container cell small-12 medum-2 large-2"
                                                    ng-if="!$root.UI.isMobile"
                                                >
                                                    <div class="view-user-events-list-item-date text-center">
                                                        <h3>
                                                            <b>
                                                                {{event.formattedShortStartDate}}
                                                            </b>
                                                        </h3>
                                                        <h6>
                                                            {{event.formattedShortStartTime}}
                                                        </h6>
                                                        <span>
                                                            TO
                                                        </span>
                                                        <h3>
                                                            <b>
                                                                {{event.formattedShortEndDate}}
                                                            </b>
                                                        </h3>
                                                        <h6>
                                                            {{event.formattedShortStartTime}}
                                                        </h6>
                                                    </div>
                                                </div>
                                                <div class="cell auto list-item">
                                                    <div class="view-user-events-list-item-details">
                                                        <h4 class="separator-center">
                                                            <b>
                                                                {{event.title}}
                                                            </b>
                                                        </h4>
                                                        <div 
                                                            class="view-user-events-list-item-date-container cell small-12 medum-2 large-2"
                                                            ng-if="$root.UI.isMobile"
                                                        >
                                                            <div class="view-client-past-events-list-item-date text-center">
                                                                <h3>
                                                                    <b>
                                                                        {{event.formattedShortStartDate}}
                                                                    </b>
                                                                </h3>
                                                                <h6>
                                                                    {{event.formattedShortStartTime}}
                                                                </h6>
                                                                <span>
                                                                    TO
                                                                </span>
                                                                <h3>
                                                                    <b>
                                                                        {{event.formattedShortEndDate}}
                                                                    </b>
                                                                </h3>
                                                                <h6>
                                                                    {{event.formattedShortStartTime}}
                                                                </h6>
                                                            </div>
                                                        </div>
                                                        <h6>
                                                            <b>
                                                                Type:
                                                            </b>
                                                            {{event.EventType.name}}
                                                        </h6>
                                                        <h6>
                                                            <b>
                                                                Group:
                                                            </b>
                                                            {{event.Group.name}}
                                                        </h6>
                                                        <h6 ng-if="event.recurring">
                                                            <b>
                                                                Recurring:
                                                            </b>
                                                            <span ng-if="event.RecurrencePattern.frequency != 'custom'">
                                                                {{event.RecurrencePattern.frequency}}
                                                            </span>
                                                            <span ng-if="event.RecurrencePattern.endDate">
                                                                Ends on {{event.RecurrencePattern.endDate}}
                                                            </span>
                                                        </h6>
                                                        <h6>
                                                            <b>
                                                                Created By:
                                                            </b>
                                                            {{event.Creator.firstName}} {{event.Creator.lastName}}
                                                        </h6>
                                                        <h6>
                                                            <b>Address: </b> 
                                                            {{event.Address.fullAddress}}
                                                        </h6>
                                                        <h6 ng-if="event.recurring">
                                                            <b>
                                                                Recurring:
                                                            </b>
                                                            <span ng-if="event.RecurrencePattern.frequency != 'custom'">
                                                                {{event.RecurrencePattern.frequency}}
                                                            </span>
                                                            <span ng-if="event.RecurrencePattern.endDate">
                                                                Ends on {{event.RecurrencePattern.endDate}}
                                                            </span>
                                                        </h6>
                                                        <br/>
                                                        <h6 ng-if="event.EventParticipants.length">
                                                            <b>
                                                                Participants:
                                                            </b>
                                                        </h6>
                                                        <div class="view-user-events-list-item-participants-container">    
                                                            <div class="grid-x align-middle">
                                                                <div 
                                                                    class="cell small-2 medium-shrink large-shrink"
                                                                    ng-repeat="participant in event.EventParticipants |
                                                                    limitTo: ($root.UI.isMobile ? 6 : 10) track by $index"
                                                                >
                                                                    <div format-users user="participant.User"></div>
                                                                    <user-icon user="participant.User"></user-icon>
                                                                </div>
                                                                <div 
                                                                    class="cell small-12 medium-auto large-auto"
                                                                    ng-if="event.EventParticipants.length > 10"
                                                                >
                                                                    <a href="events/event/{{event.id}}">
                                                                        +{{event.EventParticipants.length - 10}} more
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="view-user-events-list-item-button-container text-right">
                                                            <a 
                                                                class="success-button button"
                                                                ng-href="/events/event/{{event.id}}"
                                                            >
                                                                <i class="fal fa-search"></i> View
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                        <li 
                                            class="users-list-infinite-scroll text-center"
                                            id="userEventsListInfiniteScroll"
                                            ng-init="initEventsInfiniteScroll()"
                                            ng-show="filteredEvents.length > 20"
                                            ng-click="updateUserEventsDisplayed()"
                                        >
                                            <div class="dispatch-loader"></div>
                                        </li>
                                        <li 
                                            class="list-empty text-center"
                                            ng-show="!filteredEvents.length"
                                        >
                                            <div class="grid-container">
                                                <h3>
                                                    <b>Oops! </b>
                                                    Looks like we can't find them!
                                                    <br/>
                                                    if you still can't find the Event you're looking, 
                                                    try to double check your spelling!
                                                    
                                                </h3>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>=